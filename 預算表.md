---
layout: page
title: 預算表
permalink: /budget_table/
---

<script>

const base = "https://script.google.com/macros/s/AKfycby7IvcyV9HcIJC_khfr0c0GD91zGrfWdbqHWAIJONyZBsfy9eOQ9UrHyMKOWmpR7ZdtbQ/exec";


// const createBtn = document.createElement('button');
// createBtn.textContent = 'Create Data';
// createBtn.style.padding = '6px 10px';
// createBtn.style.border = '1px solid #aaa';
// createBtn.style.background = '#f1f1f1';
// createBtn.style.borderRadius = '6px';
// createBtn.style.cursor = 'pointer';
// createBtn.style.marginLeft = '10px';

// const deleteBtn = document.createElement('button');
// deleteBtn.textContent = 'Delete Data';
// deleteBtn.style.padding = '6px 10px';
// deleteBtn.style.border = '1px solid #aaa';
// deleteBtn.style.background = '#ffebee';
// deleteBtn.style.borderRadius = '6px';
// deleteBtn.style.cursor = 'pointer';
// deleteBtn.style.marginLeft = '10px';

// const buttonContainer = document.createElement('div');
// buttonContainer.style.position = 'fixed';
// buttonContainer.style.top = '20px';
// buttonContainer.style.left = '20px';
// buttonContainer.style.zIndex = '1000';
// buttonContainer.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
// buttonContainer.style.padding = '10px';
// buttonContainer.style.borderRadius = '8px';
// buttonContainer.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)';

const loadContent = async () => {
  const params = { name: "Show Tab Data", sheet: 2 };

  const url = `${base}?${new URLSearchParams(params)}`;
  const res = await fetch(url);
  const data = await res.json();
  const dataContainer = document.createElement('div');
  dataContainer.innerHTML = JSON.stringify(data);
  dataContainer.style.marginTop = '20px';
  document.getElementsByClassName('post-content')[0].appendChild(dataContainer);
};

const showSpinner = () => {
  console.log('顯示 spinner');
  const spinner = document.createElement('div');
  spinner.id = 'loading-spinner';
  spinner.style.position = 'fixed';
  spinner.style.top = '50%';
  spinner.style.left = '50%';
  spinner.style.transform = 'translate(-50%, -50%)';
  spinner.style.zIndex = '99999';
  spinner.style.background = 'rgba(255, 255, 255, 0.95)';
  spinner.style.padding = '20px';
  spinner.style.borderRadius = '8px';
  spinner.style.boxShadow = '0 4px 20px rgba(0,0,0,0.3)';
  spinner.style.border = '2px solid #3498db';
  spinner.innerHTML = `
    <div style="display: flex; align-items: center; gap: 10px;">
      <div style="width: 20px; height: 20px; border: 2px solid #f3f3f3; border-top: 2px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; transform: none;"></div>
      <span>載入中...</span>
    </div>
  `;
  
  const style = document.createElement('style');
  style.textContent = `
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `;
  document.head.appendChild(style);
  document.getElementsByClassName('post-content')[0].appendChild(spinner);
  console.log('Spinner 已添加到 post-content');
};

const hideSpinner = () => {
  console.log('隱藏 spinner');
  const spinner = document.getElementById('loading-spinner');
  if (spinner) {
    console.log('找到 spinner，正在移除');
    spinner.remove();
  } else {
    console.log('找不到 spinner');
  }
};

const totalContainer = document.createElement('div');
totalContainer.className = 'total-container';
totalContainer.style.width = 'calc(100% - 2 * max(20px, 5vw))';
totalContainer.style.height = 'calc(35vh - 20px)';
totalContainer.style.minHeight = '200px';
totalContainer.style.margin = '20px auto 40px auto';
totalContainer.style.padding = '10px';
totalContainer.style.position = 'relative';
totalContainer.style.top = '0';
totalContainer.style.left = '0';
totalContainer.style.zIndex = '1000';
totalContainer.style.backgroundColor = 'transparent';
totalContainer.style.borderRadius = '0';
totalContainer.style.boxShadow = 'none';
totalContainer.style.border = 'none';
totalContainer.style.overflow = 'visible';
totalContainer.style.display = 'flex';
totalContainer.style.flexDirection = 'column';
totalContainer.style.justifyContent = 'flex-start';
totalContainer.style.alignItems = 'stretch';

const mobileStyle = document.createElement('style');
mobileStyle.textContent = `
  @media (max-width: 768px) {
    .total-container {
      height: auto !important;
      min-height: 300px !important;
    }
    .content-container {
      flex-direction: row !important;
      width: 100% !important;
    }
    .total-content-container {
      width: 50% !important;
      margin-bottom: 0 !important;
    }
    .pie-chart-container {
      width: 45% !important;
      height: 200px !important;
      margin: 0 0 0 10px !important;
    }
    .budget-cards-container {
      width: calc(95% - 2 * max(10px, 3vw)) !important;
      height: calc(50vh - 100px) !important;
      top: calc(40vh + 140px) !important;
    }
    .total-amount-text {
      font-size: 18px !important;
    }
    .total-title-text {
      font-size: 16px !important;
    }
  }
`;
document.head.appendChild(mobileStyle);

const leftArrow = document.createElement('button');
leftArrow.innerHTML = '‹';
leftArrow.style.position = 'absolute';
leftArrow.style.left = '10px';
leftArrow.style.top = '50%';
leftArrow.style.transform = 'translateY(-50%)';
leftArrow.style.zIndex = '1001';
leftArrow.style.width = '30px';
leftArrow.style.height = '30px';
leftArrow.style.border = 'none';
leftArrow.style.borderRadius = '50%';
leftArrow.style.backgroundColor = 'rgba(0, 0, 0, 0.1)';
leftArrow.style.color = '#333';
leftArrow.style.fontSize = '18px';
leftArrow.style.cursor = 'pointer';
leftArrow.style.display = 'flex';
leftArrow.style.alignItems = 'center';
leftArrow.style.justifyContent = 'center';

const rightArrow = document.createElement('button');
rightArrow.innerHTML = '›';
rightArrow.style.position = 'absolute';
rightArrow.style.right = '10px';
rightArrow.style.top = '50%';
rightArrow.style.transform = 'translateY(-50%)';
rightArrow.style.zIndex = '1001';
rightArrow.style.width = '30px';
rightArrow.style.height = '30px';
rightArrow.style.border = 'none';
rightArrow.style.borderRadius = '50%';
rightArrow.style.backgroundColor = 'rgba(0, 0, 0, 0.1)';
rightArrow.style.color = '#333';
rightArrow.style.fontSize = '18px';
rightArrow.style.cursor = 'pointer';
rightArrow.style.display = 'flex';
rightArrow.style.alignItems = 'center';
rightArrow.style.justifyContent = 'center';

const budgetCardsContainer = document.createElement('div');
budgetCardsContainer.className = 'budget-cards-container';
budgetCardsContainer.id = 'budget-cards-container';
budgetCardsContainer.style.position = 'fixed';
budgetCardsContainer.style.top = 'calc(35vh + 180px)';
budgetCardsContainer.style.left = '50%';
budgetCardsContainer.style.transform = 'translateX(-50%)';
budgetCardsContainer.style.width = 'calc(70% - 2 * max(20px, 5vw))';
budgetCardsContainer.style.height = 'calc(65vh - 260px)';
budgetCardsContainer.style.backgroundColor = 'rgba(255, 255, 255, 0.95)';
budgetCardsContainer.style.borderRadius = '12px';
budgetCardsContainer.style.boxShadow = '0 8px 32px rgba(0,0,0,0.2)';
budgetCardsContainer.style.border = '1px solid rgba(255, 255, 255, 0.2)';
budgetCardsContainer.style.backdropFilter = 'blur(10px)';
budgetCardsContainer.style.overflow = 'auto';
budgetCardsContainer.style.zIndex = '999';
budgetCardsContainer.style.display = 'block';
budgetCardsContainer.style.padding = '20px 20px 40px 20px';

const budgetCardsTitle = document.createElement('h2');
budgetCardsTitle.textContent = '新增／修改預算';
budgetCardsTitle.style.textAlign = 'center';
budgetCardsTitle.style.margin = '-5px 0 20px 0';
budgetCardsTitle.style.color = '#333';
budgetCardsContainer.appendChild(budgetCardsTitle);
budgetCardsContainer.appendChild(leftArrow);
budgetCardsContainer.appendChild(rightArrow);

const columnsContainer = document.createElement('div');
columnsContainer.style.display = 'flex';
columnsContainer.style.flexDirection = 'column';
columnsContainer.style.gap = '20px';
columnsContainer.style.width = '100%';

const incomeColumn = document.createElement('div');
incomeColumn.style.display = 'flex';
incomeColumn.style.alignItems = 'center';
incomeColumn.style.gap = '15px';

const incomeTitle = document.createElement('h3');
incomeTitle.textContent = '收入：';
incomeTitle.style.margin = '0';
incomeTitle.style.color = '#2e7d32';
incomeTitle.style.fontSize = '18px';
incomeTitle.style.transform = 'translate(20px, 20px)';
incomeTitle.style.fontSize = '20px';

const incomeAmount = document.createElement('div');
incomeAmount.id = 'income-amount';
incomeAmount.textContent = '$0';
incomeAmount.style.fontSize = '24px';
incomeAmount.style.fontWeight = 'bold';
incomeAmount.style.color = '#2e7d32';
incomeAmount.style.transform = 'translate(20px, 20px)';
incomeAmount.style.fontSize = '28px';

incomeColumn.appendChild(incomeTitle);
incomeColumn.appendChild(incomeAmount);

const expenseColumn = document.createElement('div');
expenseColumn.style.display = 'flex';
expenseColumn.style.alignItems = 'center';
expenseColumn.style.gap = '15px';

const expenseTitle = document.createElement('h3');
expenseTitle.textContent = '支出：';
expenseTitle.style.margin = '0';
expenseTitle.style.color = '#d32f2f';
expenseTitle.style.fontSize = '18px';
expenseTitle.style.transform = 'translate(20px, 20px)';
expenseTitle.style.fontSize = '20px';

const expenseAmount = document.createElement('div');
expenseAmount.id = 'expense-amount';
expenseAmount.textContent = '$0';
expenseAmount.style.fontSize = '24px';
expenseAmount.style.fontWeight = 'bold';
expenseAmount.style.color = '#d32f2f';
expenseAmount.style.transform = 'translate(20px, 20px)';
expenseAmount.style.fontSize = '28px';

expenseColumn.appendChild(expenseTitle);
expenseColumn.appendChild(expenseAmount);

const totalColumn = document.createElement('div');
totalColumn.style.display = 'flex';
totalColumn.style.alignItems = 'center';
totalColumn.style.gap = '15px';

const totalTitle = document.createElement('h3');
totalTitle.textContent = '總計：';
totalTitle.style.margin = '0';
totalTitle.style.color = '#1976d2';
totalTitle.style.fontSize = '18px';
totalTitle.style.transform = 'translate(20px, 20px)';
totalTitle.style.fontSize = '20px';

const totalAmount = document.createElement('div');
totalAmount.id = 'total-amount';
totalAmount.textContent = '$0';
totalAmount.style.fontSize = '24px';
totalAmount.style.fontWeight = 'bold';
totalAmount.style.color = '#1976d2';
totalAmount.style.transform = 'translate(20px, 20px)';
totalAmount.style.fontSize = '28px';

totalColumn.appendChild(totalTitle);
totalColumn.appendChild(totalAmount);

columnsContainer.appendChild(incomeColumn);
columnsContainer.appendChild(expenseColumn);
columnsContainer.appendChild(totalColumn);

const totalContainerTitle = document.createElement('h2');
totalContainerTitle.textContent = '總計';
totalContainerTitle.style.textAlign = 'center';
totalContainerTitle.style.margin = '0 auto 10px auto';
totalContainerTitle.style.color = '#333';
totalContainerTitle.style.fontSize = '36px';
totalContainerTitle.style.fontWeight = 'normal';
totalContainerTitle.style.width = '100%';

// 圓餅圖容器
const pieChartContainer = document.createElement('div');
pieChartContainer.className = 'pie-chart-container';
pieChartContainer.id = 'pie-chart-container';
pieChartContainer.style.width = '100%';
pieChartContainer.style.height = '100%';
pieChartContainer.style.minHeight = '200px';
pieChartContainer.style.margin = '20px 0';
pieChartContainer.style.display = 'flex';
pieChartContainer.style.justifyContent = 'center';
pieChartContainer.style.alignItems = 'center';
pieChartContainer.style.backgroundColor = 'rgba(248, 249, 250, 0.8)';
pieChartContainer.style.borderRadius = '12px';
pieChartContainer.style.border = '3px solid #007bff';

// 圓餅圖佔位文字
const pieChartPlaceholder = document.createElement('div');
pieChartPlaceholder.textContent = '圓餅圖區域';
pieChartPlaceholder.style.color = '#6c757d';
pieChartPlaceholder.style.fontSize = '18px';
pieChartPlaceholder.style.fontWeight = '500';
pieChartContainer.appendChild(pieChartPlaceholder);

// 內容區域容器（包含總計內文和圓餅圖）
const contentContainer = document.createElement('div');
contentContainer.className = 'content-container';
contentContainer.style.display = 'flex';
contentContainer.style.flexDirection = 'row';
contentContainer.style.justifyContent = 'space-between';
contentContainer.style.alignItems = 'flex-start';
contentContainer.style.width = '100%';

// 總計內文容器
const totalContentContainer = document.createElement('div');
totalContentContainer.className = 'total-content-container';
totalContentContainer.style.width = '45%';
totalContentContainer.style.display = 'flex';
totalContentContainer.style.flexDirection = 'column';
totalContentContainer.style.justifyContent = 'center';
totalContentContainer.style.alignItems = 'center';
totalContentContainer.style.paddingLeft = '0px';
totalContentContainer.style.paddingTop = '0px';
totalContentContainer.appendChild(columnsContainer);

// 圓餅圖容器
pieChartContainer.style.width = '50%';
pieChartContainer.style.height = 'auto';
pieChartContainer.style.margin = '0';
pieChartContainer.style.display = 'flex';
pieChartContainer.style.justifyContent = 'center';
pieChartContainer.style.alignItems = 'center';

contentContainer.appendChild(totalContentContainer);
contentContainer.appendChild(pieChartContainer);

totalContainer.appendChild(totalContainerTitle);
totalContainer.appendChild(contentContainer);

document.addEventListener('DOMContentLoaded', async function() {
  document.getElementsByClassName('post-content')[0].appendChild(totalContainer);
  document.getElementsByClassName('post-content')[0].appendChild(budgetCardsContainer);

  showSpinner();
  
  try {
    await loadContent();
  } catch (error) {
    console.error('載入失敗:', error);
    const errorContainer = document.createElement('div');
    errorContainer.innerHTML = '載入失敗: ' + error.message;
    errorContainer.style.color = 'red';
    errorContainer.style.marginTop = '20px';
    document.getElementsByClassName('post-content')[0].appendChild(errorContainer);
  } finally {
    hideSpinner();
  }

  buttonContainer.appendChild(createBtn);
  buttonContainer.appendChild(deleteBtn);
  document.getElementsByClassName('post-content')[0].appendChild(buttonContainer);
});


// createBtn.addEventListener('click', function() {
//   const modal = document.createElement('div');
//   modal.style.position = 'fixed';
//   modal.style.top = '0';
//   modal.style.left = '0';
//   modal.style.width = '100%';
//   modal.style.height = '100%';
//   modal.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
//   modal.style.zIndex = '2000';
//   modal.style.display = 'flex';
//   modal.style.justifyContent = 'center';
//   modal.style.alignItems = 'center';

//   const formContainer = document.createElement('div');
//   formContainer.style.backgroundColor = 'white';
//   formContainer.style.padding = '30px';
//   formContainer.style.borderRadius = '10px';
//   formContainer.style.boxShadow = '0 4px 20px rgba(0,0,0,0.3)';
//   formContainer.style.width = '400px';
//   formContainer.style.maxWidth = '90vw';

//   const title = document.createElement('h2');
//   title.textContent = '新增資料';
//   title.style.marginTop = '0';
//   title.style.marginBottom = '20px';
//   title.style.textAlign = 'center';
//   title.style.color = '#333';

//   const form = document.createElement('form');
  
//   const fields = [
//     { name: 'sheet', label: 'Sheet', type: 'text', placeholder: '請輸入名稱' },
//     { name: 'range', label: 'Range', type: 'text', placeholder: '請輸入範圍' },
//     { name: 'category', label: 'Category', type: 'text', placeholder: '請輸入類別' },
//     { name: 'item', label: 'Item', type: 'text', placeholder: '請輸入項目名稱' },
//     { name: 'cost', label: 'Cost', type: 'number', placeholder: '請輸入金額' },
//     { name: 'note', label: 'Note', type: 'text', placeholder: '請輸入備註' }
//   ];

//   fields.forEach(field => {
//     const fieldContainer = document.createElement('div');
//     fieldContainer.style.marginBottom = '15px';

//     const label = document.createElement('label');
//     label.textContent = field.label + ':';
//     label.style.display = 'block';
//     label.style.marginBottom = '5px';
//     label.style.fontWeight = 'bold';
//     label.style.color = '#555';

//     const input = document.createElement('input');
//     input.type = field.type;
//     input.name = field.name;
//     input.placeholder = field.placeholder;
//     input.style.width = '100%';
//     input.style.padding = '8px';
//     input.style.border = '1px solid #ddd';
//     input.style.borderRadius = '4px';
//     input.style.fontSize = '14px';
//     input.required = true;

//     fieldContainer.appendChild(label);
//     fieldContainer.appendChild(input);
//     form.appendChild(fieldContainer);
//   });

//   const buttonGroup = document.createElement('div');
//   buttonGroup.style.display = 'flex';
//   buttonGroup.style.justifyContent = 'space-between';
//   buttonGroup.style.marginTop = '20px';

//   const submitBtn = document.createElement('button');
//   submitBtn.type = 'submit';
//   submitBtn.textContent = '提交';
//   submitBtn.style.padding = '10px 20px';
//   submitBtn.style.backgroundColor = '#4CAF50';
//   submitBtn.style.color = 'white';
//   submitBtn.style.border = 'none';
//   submitBtn.style.borderRadius = '4px';
//   submitBtn.style.cursor = 'pointer';
//   submitBtn.style.fontSize = '14px';

//   const cancelBtn = document.createElement('button');
//   cancelBtn.type = 'button';
//   cancelBtn.textContent = '取消';
//   cancelBtn.style.padding = '10px 20px';
//   cancelBtn.style.backgroundColor = '#f44336';
//   cancelBtn.style.color = 'white';
//   cancelBtn.style.border = 'none';
//   cancelBtn.style.borderRadius = '4px';
//   cancelBtn.style.cursor = 'pointer';
//   cancelBtn.style.fontSize = '14px';

//   buttonGroup.appendChild(submitBtn);
//   buttonGroup.appendChild(cancelBtn);

//   form.appendChild(buttonGroup);
//   formContainer.appendChild(title);
//   formContainer.appendChild(form);
//   modal.appendChild(formContainer);
//   document.getElementsByClassName('post-content')[0].appendChild(modal);

//     form.addEventListener('submit', async function(e) {
//       e.preventDefault();
      
//       const formData = new FormData(form);
//       const data = {};
//       for (let [key, value] of formData.entries()) {
//         data[key] = value;
//       }
      
//       const postData = {
//         name: "Add Data",
//         sheet: parseInt(data.sheet) || 2,
//         range: parseInt(data.range) || 0,
//         category: data.category || '',
//         item: data.item || '',
//         cost: parseFloat(data.cost) || 0,
//         note: data.note || ''
//       };
      
//       console.log('提交的資料:', postData);
//       console.log('POST 請求 URL:', base);
      
//       submitBtn.textContent = '提交中...';
//       submitBtn.disabled = true;
      
//       try {
//         const response = await fetch(base, {
//           method: "POST",
//           redirect: "follow",
//           keepalive: true,
//           headers: {
//             "Content-Type": "text/plain;charset=utf-8",
//           },
//           body: JSON.stringify(postData)
//         });
        
//         console.log('回應狀態:', response.status);
//         console.log('回應 headers:', response.headers);
        
//         if (response.ok) {
//           const result = await response.json();
//           console.log('伺服器回應:', result);
//           if (result.success) {
//             alert('資料提交成功！' + (result.message ? '\n' + result.message : ''));
//           } else {
//             alert('提交失敗: ' + result.message);
//           }
//         } else {
//           const errorText = await response.text();
//           console.error('錯誤回應內容:', errorText);
//           throw new Error(`HTTP error! status: ${response.status}, response: ${errorText}`);
//         }
//       } catch (error) {
//         console.error('提交失敗:', error);
//         alert('提交失敗: ' + error.message);
//       } finally {
//         submitBtn.textContent = '提交';
//         submitBtn.disabled = false;
        
//         document.getElementsByClassName('post-content')[0].removeChild(modal);
//       }
//     });

//   cancelBtn.addEventListener('click', function() {
//     document.getElementsByClassName('post-content')[0].removeChild(modal);
//   });

//   modal.addEventListener('click', function(e) {
//     if (e.target === modal) {
//       document.getElementsByClassName('post-content')[0].removeChild(modal);
//     }
//   });
// });

// deleteBtn.addEventListener('click', function() {
//   const modal = document.createElement('div');
//   modal.style.position = 'fixed';
//   modal.style.top = '0';
//   modal.style.left = '0';
//   modal.style.width = '100%';
//   modal.style.height = '100%';
//   modal.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
//   modal.style.zIndex = '2000';
//   modal.style.display = 'flex';
//   modal.style.justifyContent = 'center';
//   modal.style.alignItems = 'center';

//   const formContainer = document.createElement('div');
//   formContainer.style.backgroundColor = 'white';
//   formContainer.style.padding = '30px';
//   formContainer.style.borderRadius = '10px';
//   formContainer.style.boxShadow = '0 4px 20px rgba(0,0,0,0.3)';
//   formContainer.style.width = '400px';
//   formContainer.style.maxWidth = '90vw';

//   const title = document.createElement('h2');
//   title.textContent = '刪除資料';
//   title.style.marginTop = '0';
//   title.style.marginBottom = '20px';
//   title.style.textAlign = 'center';
//   title.style.color = '#333';

//   const form = document.createElement('form');
  
//   const fields = [
//     { name: 'sheet', label: 'Sheet', type: 'text', placeholder: '請輸入名稱' },
//     { name: 'range', label: 'Range', type: 'text', placeholder: '請輸入範圍' },
//     { name: 'category', label: 'Category', type: 'text', placeholder: '請輸入類別' },
//     { name: 'item', label: 'Item', type: 'text', placeholder: '請輸入項目名稱' },
//     { name: 'cost', label: 'Cost', type: 'number', placeholder: '請輸入金額' },
//     { name: 'note', label: 'Note', type: 'text', placeholder: '請輸入備註' }
//   ];

//   fields.forEach(field => {
//     const fieldContainer = document.createElement('div');
//     fieldContainer.style.marginBottom = '15px';

//     const label = document.createElement('label');
//     label.textContent = field.label + ':';
//     label.style.display = 'block';
//     label.style.marginBottom = '5px';
//     label.style.fontWeight = 'bold';
//     label.style.color = '#555';

//     const input = document.createElement('input');
//     input.type = field.type;
//     input.name = field.name;
//     input.placeholder = field.placeholder;
//     input.style.width = '100%';
//     input.style.padding = '8px';
//     input.style.border = '1px solid #ddd';
//     input.style.borderRadius = '4px';
//     input.style.fontSize = '14px';
//     input.required = true;

//     fieldContainer.appendChild(label);
//     fieldContainer.appendChild(input);
//     form.appendChild(fieldContainer);
//   });

//   const buttonGroup = document.createElement('div');
//   buttonGroup.style.display = 'flex';
//   buttonGroup.style.justifyContent = 'space-between';
//   buttonGroup.style.marginTop = '20px';

//   const submitBtn = document.createElement('button');
//   submitBtn.type = 'submit';
//   submitBtn.textContent = '提交';
//   submitBtn.style.padding = '10px 20px';
//   submitBtn.style.backgroundColor = '#4CAF50';
//   submitBtn.style.color = 'white';
//   submitBtn.style.border = 'none';
//   submitBtn.style.borderRadius = '4px';
//   submitBtn.style.cursor = 'pointer';
//   submitBtn.style.fontSize = '14px';

//   const cancelBtn = document.createElement('button');
//   cancelBtn.type = 'button';
//   cancelBtn.textContent = '取消';
//   cancelBtn.style.padding = '10px 20px';
//   cancelBtn.style.backgroundColor = '#f44336';
//   cancelBtn.style.color = 'white';
//   cancelBtn.style.border = 'none';
//   cancelBtn.style.borderRadius = '4px';
//   cancelBtn.style.cursor = 'pointer';
//   cancelBtn.style.fontSize = '14px';

//   buttonGroup.appendChild(submitBtn);
//   buttonGroup.appendChild(cancelBtn);

//   form.appendChild(buttonGroup);
//   formContainer.appendChild(title);
//   formContainer.appendChild(form);
//   modal.appendChild(formContainer);
//   document.getElementsByClassName('post-content')[0].appendChild(modal);

//     form.addEventListener('submit', async function(e) {
//       e.preventDefault();
      
//       const formData = new FormData(form);
//       const data = {};
//       for (let [key, value] of formData.entries()) {
//         data[key] = value;
//       }
      
//       const postData = {
//         name: "Delete Data",
//         sheet: parseInt(data.sheet) || 2,
//         range: parseInt(data.range) || 0,
//         category: data.category || '',
//         item: data.item || '',
//         cost: parseFloat(data.cost) || 0,
//         note: data.note || ''
//       };
      
//       console.log('提交的資料:', postData);
//       console.log('POST 請求 URL:', base);
      
//       submitBtn.textContent = '提交中...';
//       submitBtn.disabled = true;
      
//       try {
//         const response = await fetch(base, {
//           method: "POST",
//           redirect: "follow",
//           keepalive: true,
//           headers: {
//             "Content-Type": "text/plain;charset=utf-8",
//           },
//           body: JSON.stringify(postData)
//         });
        
//         console.log('回應狀態:', response.status);
//         console.log('回應 headers:', response.headers);
        
//         if (response.ok) {
//           const result = await response.json();
//           console.log('伺服器回應:', result);
//           if (result.success) {
//             alert('資料提交成功！' + (result.message ? '\n' + result.message : ''));
//           } else {
//             alert('提交失敗: ' + result.message);
//           }
//         } else {
//           const errorText = await response.text();
//           console.error('錯誤回應內容:', errorText);
//           throw new Error(`HTTP error! status: ${response.status}, response: ${errorText}`);
//         }
//       } catch (error) {
//         console.error('提交失敗:', error);
//         alert('提交失敗: ' + error.message);
//       } finally {
//         submitBtn.textContent = '提交';
//         submitBtn.disabled = false;
        
//         document.getElementsByClassName('post-content')[0].removeChild(modal);
//       }
//     });

//   cancelBtn.addEventListener('click', function() {
//     document.getElementsByClassName('post-content')[0].removeChild(modal);
//   });

//   modal.addEventListener('click', function(e) {
//     if (e.target === modal) {
//       document.getElementsByClassName('post-content')[0].removeChild(modal);
//     }
//   });
// });

</script>